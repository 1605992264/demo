<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.yexiao.demo.mapper.UserMapper">

    <select id="verificationUserName" resultType="int">
        select count(*) from sys_user where username = #{value}
    </select>


    <delete id="removeById">
        delete from sys_user where id = #{value}
    </delete>

    <select id="findUserInfo" resultType="com.yexiao.demo.domain.UserDO">
        SELECT
            u.id,
            u.username,
            u.PASSWORD,
            u.NAME,
            u.sex,
            u.mobile,
            r.`name` AS roleName,
            r.alias AS roleAlias,
            p.`name` AS permissionName,
            p.alias ASpermissionalias
        FROM
            sys_user u
            LEFT JOIN sys_user_role ur ON u.id = ur.user_id
            LEFT JOIN sys_role r ON ur.role_id = r.id
            LEFT JOIN sys_role_permission rp ON r.id = rp.role_id
            LEFT JOIN sys_permission p ON rp.permission_id = p.id
        <where>
            <if test="userId != null and userId != ''">
                AND u.id = #{userId}
            </if>
        </where>
    </select>

</mapper>